import mime from"/js/libraries/mime.js";import{stringToArrayBuffer}from"/js/functions.js";export default function initializeUI(e){const a=document.getElementById("panelContainer"),s=document.getElementById("editorContainer"),t=function(){const o=[];let l;return window.addEventListener("mousemove",e=>l=e.pageX),{resizeOnce(){var e=getComputedStyle(r),e=parseInt(e.width.slice(0,-2)),t=r.getBoundingClientRect().x;s.style.width=window.innerWidth-t-e+"px",fileSystemManager.editor.layout(),window.tutorial&&fileSystemManager.tutorialDifferenceEditor.layout()},startResize(e){r.children[0].style.backgroundColor="#595959";const t=getComputedStyle(r),n=parseInt(t.width.slice(0,-2));let i=e.pageX-r.getBoundingClientRect().x;o.push(setInterval(()=>{(l=l-i<n?i=0:l)-i>window.innerWidth-2*n&&(l=window.innerWidth-n,i=0),r.style.left=l-i+"px",a.style.width=l-i+"px",s.style.width=window.innerWidth-l+i-n+"px",fileSystemManager.editor.layout(),window.tutorial&&fileSystemManager.tutorialDifferenceEditor.layout()},20))},stopResize(){r.children[0].style.removeProperty("background-color"),o.filter(e=>clearInterval(e))}}}(),r=document.getElementById("containersSeparator");r.addEventListener("mousedown",e=>t.startResize(e)),window.addEventListener("mouseup",()=>t.stopResize()),window.addEventListener("resize",()=>t.resizeOnce());for(const c of document.getElementsByClassName("panelTab"))c.addEventListener("click",e=>selectTab(e.target.id.slice(0,-8)));selectTab(e);const n=document.getElementById("fileOptionEncodingContainer");n.addEventListener("click",e=>{e.stopPropagation(),n.style.height="fit-content"===n.style.height?"100%":"fit-content"}),document.body.addEventListener("click",()=>n.style.height="100%");for(const m of document.getElementsByClassName("fileEncodingOption"))m.addEventListener("click",()=>fileSystemManager.changeFileEncodingScheme(fileSystemManager.activeFilePath,fileSystemManager.activeFile,m.getAttribute("data-value")));const i=document.getElementById("editorTabFileName"),o=document.getElementById("editorTabPreview"),d=document.getElementById("filePreviewMask"),l=(i.addEventListener("click",()=>{for(const e of document.getElementsByClassName("filePreviewFrame"))e.remove();d.style.display="none"}),o.addEventListener("click",()=>{d.style.display="block";var e=fileSystemManager.activeFile,t=fileSystemManager.activePath;const n=(t.substring(4)+" "+e).replaceAll(" ","/");var i=fileSystemManager.getFileContents(t,e),o=fileSystemManager.getFileEncodingScheme(t,e);const l=document.createElement("iframe");l.classList.add("filePreviewFrame"),l.width=d.offsetWidth,s.append(l),l.addEventListener("load",()=>d.style.display="none"),webCodeExecutor.executeFilesList([[(t.substring(4)+" "+e).trim(),stringToArrayBuffer(i,o),mime.getType(e)||"text/plain"]],()=>l.src=executorRootURL+n)}),document.getElementsByClassName("editorTab"));for(const y of l)y.addEventListener("click",()=>{for(const y of l)y.children[0].style.backgroundColor=null;y.children[0].style.backgroundColor="#cccccc"})}function selectTab(e){for(const t of document.getElementsByClassName("panelTab"))t.style.backgroundColor="#eeeeee";for(const n of document.getElementsByClassName("panelContent"))n.style.display="none";document.getElementById(e+"PanelTab").style.backgroundColor="#cccccc",document.getElementById(e+"PanelContent").style.display="block"}export{selectTab};